(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{967:function(e,t,a){Promise.resolve().then(a.bind(a,3356))},3356:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var s=a(7437),n=a(2265),l=a(6705),i=a(105),r=a(6704),o=a(432);function Home(){let[e,t]=(0,n.useState)("mock"),[a,r]=(0,n.useState)([]),[c,u]=(0,n.useState)({wavelengths:[],response:[],ideal:[]}),[d,m]=(0,n.useState)([0,2]);(0,n.useEffect)(()=>{fetch("/config").then(e=>e.json()).then(e=>{r(Array(e.num_channels).fill((e.v_range[0]+e.v_range[1])/2)),m(e.v_range)})},[]),(0,n.useEffect)(()=>{a.length&&simulate()},[a]);let simulate=async()=>{let e=await fetch("/simulate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});u(await e.json())},runOptimize=async()=>{let t=await fetch("/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();r(a.voltages),u(a)};return(0,s.jsxs)("main",{className:"p-4 max-w-3xl mx-auto",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold mb-4 flex items-center",children:["光学滤波器参数寻优 ",(0,s.jsx)(o.Z,{className:"w-6 h-6 text-green-500 ml-2"})]}),(0,s.jsxs)(l.Ee,{value:e,onChange:t,className:"flex space-x-4 mb-4",children:[(0,s.jsx)(l.Ee.Option,{value:"mock",className:"cursor-pointer px-3 py-1 rounded bg-gray-200 ui-checked:bg-blue-500 ui-checked:text-white",children:"模拟"}),(0,s.jsx)(l.Ee.Option,{value:"real",className:"cursor-pointer px-3 py-1 rounded bg-gray-200 ui-checked:bg-blue-500 ui-checked:text-white",children:"实际"})]}),a.map((e,t)=>(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsxs)("label",{className:"mr-2",children:["通道",t+1]}),(0,s.jsx)("input",{type:"range",min:d[0],max:d[1],step:"0.01",value:e,className:"w-60 align-middle",onChange:e=>{let s=[...a];s[t]=parseFloat(e.target.value),r(s)}}),(0,s.jsx)("span",{className:"ml-2 w-12 inline-block text-right",children:e.toFixed(2)})]},t)),(0,s.jsx)("button",{onClick:runOptimize,className:"mt-2 px-4 py-1 bg-blue-600 text-white rounded",children:"开始优化"}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(i.x1,{data:{labels:c.wavelengths,datasets:[{label:"理想波形",data:c.ideal,borderColor:"blue",fill:!1},{label:"响应曲线",data:c.response,borderColor:"red",fill:!1}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1}}})})]})}r.kL.register(r.jn,r.od,r.f$,r.uw,r.De)}},function(e){e.O(0,[674,309,971,472,744],function(){return e(e.s=967)}),_N_E=e.O()}]);
